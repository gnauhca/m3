{"version":3,"sources":["webpack:///webpack/bootstrap 88025508289ca51ac888","webpack:///./js/main.js","webpack:///./css/common.scss","webpack:///./js/common/time.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA,c;AACA,wBAA8B;;AAE9B;AACA;;AAEA;AACA;;AAEA;AACA,wCAAuC,+BAA+B;;AAEtE;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;AAGD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA,4CAA2C,4CAA4C;AACvF;;AAEA,EAAC;;;;;;;;;;;;;;;;;;;;AClED,0C;;;;;;;;;;;ACAA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iC;AACA;AACA;AACA;AACA,sB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,gC;AACA,MAAK;AACL;AACA,IAAG;;AAEH;AACA,GAAE,E;AACF,EAAC;;AAED;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc;;AAEd;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA,sCAAqC,sBAAsB,EAAE;AAC7D;AACA,KAAI;AACJ,mCAAkC;AAClC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,sBAAsB,EAAE;AAC3D;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 88025508289ca51ac888\n **/","(function() { \nrequire('../css/common.scss');//return;\n\nwindow.M3 = {};\nM3.viewManager = require('./view/view-manager.js');\n\n// todo: webgl 检查\n//\n\n// 基本场景\nM3.renderer = new THREE.WebGLRenderer({ antialias: true , alpha: true});\n\nM3.scene = new THREE.Scene();\ndocument.body.appendChild(M3.renderer.domElement);\nM3.renderer.setClearColor(0x2abced, 0);\n\nvar winWidth = window.innerWidth;\nvar winHeight = window.innerHeight;\n\nM3.renderer.setSize(winWidth, winHeight);\n\n\nM3.camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);\n\n// main render tick\nvar Time = require('time');\nvar m3Time = new Time();\n\nM3.tick = m3Time.addTick(function() {\n\tM3.renderer.render(M3.scene, M3.camera);\n});\n\n\nwindow.addEventListener('resize', function() {\n\twinWidth = window.innerWidth;\n\twinHeight = window.innerHeight;\n\tM3.camera.aspect = winWidth / winHeight;\n\tM3.camera.updateProjectionMatrix();\n\tM3.renderer.setSize(winWidth, winHeight);\n});\n\n\n/* helper */\nvar axisHelper = new THREE.AxisHelper( 100 );\nM3.scene.add( axisHelper );\n\nvar size = 400;\nvar step = 10;\n\n// var gridHelperX = new THREE.GridHelper( size, step, 0xff0000 );\n// gridHelperX.rotation.z = Math.PI / 2;\n// M3.scene.add( gridHelperX );\n\n// var gridHelperY = new THREE.GridHelper( size, step, 0x00ff00 );\n// M3.scene.add( gridHelperY );\n\n// var gridHelperZ = new THREE.GridHelper( size, step, 0x0000ff );\n// gridHelperZ.rotation.x = Math.PI / 2;\n// M3.scene.add( gridHelperZ );\n\n\n\n// M3.viewManager.activateView('index');\n// M3.viewManager.activateView('display', {mobiles: ['pro5'/*, 'pro6', 'mx5', 'mx6'*/]});\nM3.viewManager.activateView('select');\n\n})();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/main.js\n ** module id = 0\n ** module chunks = 0\n **/","// removed by extract-text-webpack-plugin\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./css/common.scss\n ** module id = 1\n ** module chunks = 0\n **/","/* 时间 */\nvar TIME = {\n\n\t// 所有时间body对象\n\tbodys : []\n}\n\nstop = false;\nTIME.addBody = function(timeBody) {\n\tthis.bodys.push(timeBody);\n}\n\nTIME.removeBody = function(timeBody) {\n\tvar index = this.bodys.indexOf(timeBody);\n\n\tif (index !== -1) {\n\t\tthis.bodys.splice(index, 1);\n\t}\n}\n\nTIME.tick = function() {\n\tTIME.handleFrame();\n\n\tif (!stop) {\n\t\trequestAnimationFrame(TIME.tick);\n\t\t//setTimeout(TIME.tick, 20);\n\t}\n}\n\nTIME.start = function() {\n\tstop = false;\n\tthis.tick();\n}\n\nTIME.stop = function() {\n\tstop = true;\n}\n\nTIME.handleFrame = (function() { \n\tvar now = (new Date()).getTime();\n\tvar last = now;\n\tvar delta;\n\treturn (function() { \n\n\t\tdelta = now - last;\n\t\tdelta = delta > 500 ? 30 : (delta < 16? 16 : delta);\n\n\t\t//console.log(TIME.bodys);\n\t\tTIME.bodys.forEach(function(body) {\n\t\t\tif (!body.isStop) {\n\t\t\t\tbody.ticks.forEach(function(tick) {\n\t\t\t\t\ttick.fn && tick.fn(delta); \n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tTWEEN.update();\n\t});\t\n})();\n\nTIME.tick();\n\n\n/* 时间物体类，提供两个时机，帧更新，固定间隔更新，每一个有时间概念的物体，就继承 */\nclass Time {\n\n\tconstructor() {\n\t\tTIME.addBody(this);\n\t\tthis.ticks = [];\n\t\tthis.tweens = [];\n\t\tthis.isStop = false;\n\t}\n\n\n\t/**\n\t * 该物体灭亡\n\t */\n\tdestory() {\n\t\tTIME.removeBody(this);\n\t}\n\n\t/** \n\t * 帧更新\n\t * @param timegap 与上一帧的时间间隔\n\t */\n\taddTick(fn) {\n\t\tvar tick = {'fn': fn.bind(this)};\n\n\t\ttick.isStop = false;\n\t\tthis.ticks.push(tick);\n\t\treturn tick;\n\t}\n\n\tremoveTick(tick) {\n\t\tif (!tick) {\n\t\t\t// remove all\n\t\t\tthis.ticks = [];\n\t\t\treturn;\n\t\t}\n\n\t\tvar index = this.ticks.indexOf(tick);\n\n\t\tif (index !== -1) {\n\t\t\tthis.ticks.splice(index, 1);\n\t\t}\n\t}\n\n\t/** \n\t * tween\n\t */\n\taddTween(tween) {\n\t\tthis.tweens.push(tween);\n\t}\n\n\t/*\n\t * tweenObj\n\t */\n\taddTHREEObjTween(threeObj, target, dur, tweenObj) {\t\t\n\t\tvar that = this;\n\t\tvar init = {};\n\t\tvar dest = {};\n\t    \n\t    var attrs = ['x', 'y', 'z', 'r', 'g', 'b', 'opacity'];\n\t\tvar separater = '_';\n\n\t\tfor (let key in target) {\n\t\t\tlet destKey = key;\n\t\t\tif (typeof target[key] === 'object') {\n\t\t\t\tfor (let cKey in target[key]) {\n\t\t\t\t\tif (attrs.indexOf(cKey) !== -1) {\n\t\t\t\t\t\tdestKey += cKey;\n\t\t\t\t\t\tdest[destKey] = target[key][cKey];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdest[destKey] = target[key];\n\t\t\t}\n\n\t\t\tif (destKey.indexOf('lookAt') === -1) {\n\t\t\t\tlet keyArr = destKey.split('_');\n\t\t\t\tlet subObj = threeObj;\n\n\t\t\t\tkeyArr.forEach(function(subKey) { subObj = subObj[key]; });\n\t\t\t\tinit[destKey] = subObj;\n\t\t\t} else {\n\t\t\t\tinit[destKey] = dest[destKey]; // lookAt\n\t\t\t}\n\t\t}\n\n\t\tvar tween;\n\t\ttweenObj = tweenObj || {};\n\t\ttween = new TWEEN.Tween(init)\n\t\ttween.to(dest, dur)\n\t\t\t.easing(tweenObj.easing || TWEEN.Easing.Cubic.InOut)\n\t\t\t.onUpdate(function() {\n\t\t\t\tlet current = this;\n\t\t\t\tfor (let currentKey in current) {\n\t\t\t\t\tif (currentKey.indexOf['lookAt'] !== -1) {\n\t\t\t\t\t\tlet lookAt = current[currentKey];\n\t\t\t\t\t\tthreeObj.lookAt(new Vector3(lookAt.x, lookAt.y, lookAt.z));\n\t\t\t\t\t}\n\t\t\t\t\tlet keyArr = currentKey.split('_');\n\t\t\t\t\tlet last = keyArr.pop();\n\t\t\t\t\tlet subObj = threeObj;\n\t\t\t\t\tkeyArr.forEach(function(key) { subObj = subObj[key]; });\n\t\t\t\t\tsubObj[last] = current[currentKey];\n\t\t\t\t}\n\t\t\t\ttweenObj.onUpdate && tweenObj.onUpdate();\n\t\t\t})\n\t\t\t.onComplete(function() {\n\t\t\t\tthat.removeTween(tween);\n\t\t\t\ttweenObj.onComplete && tweenObj.onComplete();\n\t\t\t});\n\n\t\tthis.tweens.push(tween);\n\t\treturn tween;\n\t}\n\n\tremoveTween(tween) {\n\t\tif (!tween) {\n\t\t\t// remove all\n\t\t\tthis.tween = [];\n\t\t\treturn;\n\t\t}\n\n\t\tvar index = this.tweens.indexOf(tween);\n\n\t\tif (index !== -1) {\n\t\t\t//tween.stop();\n\t\t\tthis.tweens.splice(index, 1);\n\t\t}\n\t}\n\n\t// stop 暂停时间\n\tstop() {\n\t\tthis.isStop = true;\n\t\tthis.tweens.forEach(function(tween) {\n\t\t\ttween.stop();\n\t\t});\n\t}\n\n\tstart() {\n\t\tthis.isStop = false;\n\t\tthis.tweens.forEach(function(tween) {\n\t\t\ttween.start();\n\t\t});\n\t}\n}\n\nexport default Time;\n\n\n\n\n\n\n\n\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./js/common/time.js\n ** module id = 7\n ** module chunks = 0\n **/"],"sourceRoot":""}